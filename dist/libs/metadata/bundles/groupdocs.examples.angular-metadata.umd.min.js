!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/platform-browser"),require("@angular/core"),require("@angular/common"),require("@angular/common/http"),require("@groupdocs.examples.angular/common-components"),require("rxjs"),require("@fortawesome/angular-fontawesome"),require("moment"),require("@angular/forms"),require("ng2-date-picker")):"function"==typeof define&&define.amd?define("@groupdocs.examples.angular/metadata",["exports","@angular/platform-browser","@angular/core","@angular/common","@angular/common/http","@groupdocs.examples.angular/common-components","rxjs","@fortawesome/angular-fontawesome","moment","@angular/forms","ng2-date-picker"],t):t(((e=e||self).groupdocs=e.groupdocs||{},e.groupdocs.examples=e.groupdocs.examples||{},e.groupdocs.examples.angular=e.groupdocs.examples.angular||{},e.groupdocs.examples.angular.metadata={}),e.ng.platformBrowser,e.ng.core,e.ng.common,e.ng.common.http,e.commonComponents,e.rxjs,e.angularFontawesome,e.moment_,e.ng.forms,e.ng2DatePicker)}(this,(function(e,t,o,r,i,n,a,p,s,d,l){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function c(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],r=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}var u=function(){function e(e,t){this._http=e,this._config=t}return e.prototype.loadFiles=function(e){return this._http.post(this._config.getMetadataApiEndpoint()+n.Api.LOAD_FILE_TREE,{path:e},n.Api.httpOptionsJson)},e.prototype.loadFile=function(e){return this._http.post(this._config.getMetadataApiEndpoint()+n.Api.LOAD_DOCUMENT_DESCRIPTION,e,n.Api.httpOptionsJson)},e.prototype.loadProperties=function(e){return this._http.post(this._config.getMetadataApiEndpoint()+n.Api.LOAD_DOCUMENT_PROPERTIES,e,n.Api.httpOptionsJson)},e.prototype.loadPropertiesNames=function(e){return this._http.post(this._config.getMetadataApiEndpoint()+n.Api.LOAD_DOCUMENT_PROPERTIES_NAMES,e,n.Api.httpOptionsJson)},e.prototype.saveProperty=function(e){return this._http.post(this._config.getMetadataApiEndpoint()+n.Api.SAVE_PROPERTY,e,n.Api.httpOptionsJson)},e.prototype.removeProperty=function(e){return this._http.post(this._config.getMetadataApiEndpoint()+n.Api.REMOVE_PROPERTY,e,n.Api.httpOptionsJson)},e.prototype.cleanMetadata=function(e){return this._http.post(this._config.getMetadataApiEndpoint()+n.Api.CLEAN_METADATA,e,n.Api.httpOptionsJson)},e.prototype.upload=function(e,t,o){var r=new FormData;return r.append("file",e),r.append("rewrite",String(o)),t&&r.append("url",t),this._http.post(this._config.getMetadataApiEndpoint()+n.Api.UPLOAD_DOCUMENTS,r)},e.prototype.loadPage=function(e,t){return this._http.post(this._config.getMetadataApiEndpoint()+n.Api.LOAD_DOCUMENT_PAGE,{guid:e.guid,password:e.password,page:t},n.Api.httpOptionsJson)},e.prototype.getDownloadUrl=function(e){return this._config.getMetadataApiEndpoint()+n.Api.DOWNLOAD_DOCUMENTS+"/?path="+e.guid},e.prototype.exportProperties=function(e){return this._http.post(this._config.getMetadataApiEndpoint()+n.Api.EXPORT_METADATA,e,n.Api.httpOptionsJsonResponseTypeBlob)},e.prototype.loadPrint=function(e){return this._http.post(this._config.getMetadataApiEndpoint()+n.Api.LOAD_PRINT,{guid:e.guid,password:e.password},n.Api.httpOptionsJson)},e.decorators=[{type:o.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:i.HttpClient},{type:n.ConfigService}]},e.ngInjectableDef=o.ɵɵdefineInjectable({factory:function(){return new e(o.ɵɵinject(i.HttpClient),o.ɵɵinject(n.ConfigService))},token:e,providedIn:"root"}),e}();var g=function(){};var f=function(){};var h,m=function(){function e(e,t){this._http=e,this._config=t,this._metadataConfig=new a.BehaviorSubject(new f),this._updatedConfig=this._metadataConfig.asObservable()}return Object.defineProperty(e.prototype,"updatedConfig",{get:function(){return this._updatedConfig},enumerable:!0,configurable:!0}),e.prototype.load=function(){var e=this;return new Promise((function(t,o){var r=e._config.getConfigEndpoint(n.Api.METADATA_APP);e._http.get(r,n.Api.httpOptionsJson).toPromise().then((function(o){var r=o;e._metadataConfig.next(r),t()})).catch((function(e){o("Could not load metadata config: "+JSON.stringify(e))}))}))},e.decorators=[{type:o.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:i.HttpClient},{type:n.ConfigService}]},e.ngInjectableDef=o.ɵɵdefineInjectable({factory:function(){return new e(o.ɵɵinject(i.HttpClient),o.ɵɵinject(n.ConfigService))},token:e,providedIn:"root"}),e}();var y={Read:0,Update:1,Remove:2,Add:4,AddOrUpdate:5,Full:7};y[y.Read]="Read",y[y.Update]="Update",y[y.Remove]="Remove",y[y.Add]="Add",y[y.AddOrUpdate]="AddOrUpdate",y[y.Full]="Full";var v={Empty:0,String:1,Boolean:2,DateTime:3,TimeSpan:4,Integer:5,Long:6,Double:7,StringArray:8,ByteArray:9,DoubleArray:10,IntegerArray:11,LongArray:12,Metadata:13,MetadataArray:14,Guid:15,PropertyValueArray:16};v[v.Empty]="Empty",v[v.String]="String",v[v.Boolean]="Boolean",v[v.DateTime]="DateTime",v[v.TimeSpan]="TimeSpan",v[v.Integer]="Integer",v[v.Long]="Long",v[v.Double]="Double",v[v.StringArray]="StringArray",v[v.ByteArray]="ByteArray",v[v.DoubleArray]="DoubleArray",v[v.IntegerArray]="IntegerArray",v[v.LongArray]="LongArray",v[v.Metadata]="Metadata",v[v.MetadataArray]="MetadataArray",v[v.Guid]="Guid",v[v.PropertyValueArray]="PropertyValueArray";var b={Undefined:0,Root:1,Xmp:2,Exif:3,Iptc:4,DublinCore:5,ImageResourceBlock:6,FileFormat:7,DigitalSignature:8,Presentation:9,Spreadsheet:10,WordProcessing:11,Diagram:12,Note:13,ProjectManagement:14,Pdf:15,DocumentStatistics:16,Psd:17,Jpeg2000:18,Dicom:19,Bmp:20,Wav:21,ID3V1:22,ID3V2:23,MpegAudio:24,Lyrics3:25,ApeV2:26,Avi:27,Flv:28,Asf:29,Mov:30,Matroska:31,Zip:32,VCard:33,Epub:34,OpenType:35,Cad:36,Eml:37,Msg:38,Torrent:39};b[b.Undefined]="Undefined",b[b.Root]="Root",b[b.Xmp]="Xmp",b[b.Exif]="Exif",b[b.Iptc]="Iptc",b[b.DublinCore]="DublinCore",b[b.ImageResourceBlock]="ImageResourceBlock",b[b.FileFormat]="FileFormat",b[b.DigitalSignature]="DigitalSignature",b[b.Presentation]="Presentation",b[b.Spreadsheet]="Spreadsheet",b[b.WordProcessing]="WordProcessing",b[b.Diagram]="Diagram",b[b.Note]="Note",b[b.ProjectManagement]="ProjectManagement",b[b.Pdf]="Pdf",b[b.DocumentStatistics]="DocumentStatistics",b[b.Psd]="Psd",b[b.Jpeg2000]="Jpeg2000",b[b.Dicom]="Dicom",b[b.Bmp]="Bmp",b[b.Wav]="Wav",b[b.ID3V1]="ID3V1",b[b.ID3V2]="ID3V2",b[b.MpegAudio]="MpegAudio",b[b.Lyrics3]="Lyrics3",b[b.ApeV2]="ApeV2",b[b.Avi]="Avi",b[b.Flv]="Flv",b[b.Asf]="Asf",b[b.Mov]="Mov",b[b.Matroska]="Matroska",b[b.Zip]="Zip",b[b.VCard]="VCard",b[b.Epub]="Epub",b[b.OpenType]="OpenType",b[b.Cad]="Cad",b[b.Eml]="Eml",b[b.Msg]="Msg",b[b.Torrent]="Torrent";var w=function(){};var P=function(){};var k=function(){};var S=function(){};var A=function(){};var D=((h={})[b.WordProcessing]="Document Properties",h[b.Spreadsheet]="Workbook Properties",h[b.Presentation]="Presentation Properties",h[b.ProjectManagement]="Project Properties",h[b.Diagram]="Diagram Properties",h[b.Note]="Note Properties",h[b.Pdf]="PDF Properties",h[b.FileFormat]="File Format Info",h[b.DocumentStatistics]="Document Statistics",h[b.DublinCore]="Dublin Core Properties",h[b.ImageResourceBlock]="Image Resources",h[b.MpegAudio]="Mpeg Audio Properties",h[b.DigitalSignature]="Digital Signature Properties",h),M={NotePage:"Page",ZipFile:"Archived File",TorrentSharedFilePackage:"Shared File",MovAtom:"Atom",CanonMakerNotePackage:"Canon Makernote",NikonMakerNotePackage:"Nikon Makernote",PanasonicMakerNotePackage:"Panasonic Makernote",SonyMakerNotePackage:"Sony Makernote",MatroskaSegment:"Segment",MatroskaAudioTrack:"Track",MatroskaSubtitleTrack:"Track",MatroskaVideoTrack:"Track",MatroskaTrack:"Track",MatroskaTag:"Tag",MatroskaEbmlHeader:"Header",VCardCard:"Card",AsfCodec:"Codec",AsfBaseStreamProperty:"Stream",AsfAudioStreamProperty:"Stream",AsfVideoStreamProperty:"Stream",AsfMetadataDescriptorCollection:"Descriptors",OpenTypeFont:"Font"},x=function(){function e(e,t,o,r,i,a,p,s,d,l){this.metadataService=e,this.modalService=t,this.configService=o,this.uploadFilesService=r,this.navigateService=i,this.zoomService=a,this.pagePreloadService=p,this.passwordService=s,this.loadingMaskService=d,this.windowService=l,this.title="metadata",this.files=[],this.countPages=0,this.formatDisabled=!0,this.browseFilesModal=n.CommonModals.BrowseFiles,this.previewZoom=100,this.fileWasDropped=!1,this.disabled=!1,this.showSidePanel=!0}return e.prototype.ngOnInit=function(){var e=this;this.isDesktop=this.windowService.isDesktop(),this.windowService.onResize.subscribe((function(t){e.isDesktop=e.windowService.isDesktop(),e.refreshZoom()})),this.configService.updatedConfig.subscribe((function(t){e.metadataConfig=t})),this.uploadFilesService.uploadsChange.subscribe((function(t){if(t){var o=void 0;for(o=0;o<t.length;o++)e.metadataService.upload(t.item(o),"",e.metadataConfig.rewrite).subscribe((function(t){e.fileWasDropped?e.selectFile(t.guid,"",""):e.selectDir("")}))}})),this.pagePreloadService.checkPreload.subscribe((function(t){if(0!==e.metadataConfig.preloadPageCount)for(var o=t;o<t+2;o++)o>0&&o<=e.countPages&&!e.file.pages[o-1].data&&e.preloadPages(o,o)})),this.passwordService.passChange.subscribe((function(t){e.selectFile(e.credentials.guid,t,n.CommonModals.PasswordRequired)})),""!==this.metadataConfig.defaultDocument&&(this.isLoading=!0,this.selectFile(this.metadataConfig.defaultDocument,"","")),this.initialFile&&this.selectFile(this.initialFile,null,null)},e.prototype.ngAfterViewInit=function(){var e=this;this.loadingMaskService.onLoadingChanged.subscribe((function(t){return e.isLoading=t})),this.refreshZoom()},Object.defineProperty(e.prototype,"rewriteConfig",{get:function(){return!this.metadataConfig||this.metadataConfig.rewrite},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"downloadConfig",{get:function(){return!this.metadataConfig||this.metadataConfig.download},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"uploadConfig",{get:function(){return!this.metadataConfig||this.metadataConfig.upload},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"browseConfig",{get:function(){return!this.metadataConfig||this.metadataConfig.browse},enumerable:!0,configurable:!0}),e.prototype.openModal=function(e){this.modalService.open(e)},e.prototype.closeModal=function(e){this.modalService.close(e)},e.prototype.selectDir=function(e){var t=this;this.metadataService.loadFiles(e).subscribe((function(e){return t.files=e||[]}))},e.prototype.selectFile=function(e,t,o){var r=this;this.credentials={guid:e,password:t},this.file=null,this.metadataService.loadFile(this.credentials).subscribe((function(e){if(r.file=e,r.formatDisabled=!r.file,e){e.pages&&e.pages[0]&&(r.pageHeight=e.pages[0].height,r.pageWidth=e.pages[0].width,r.options=r.zoomOptions(),r.refreshZoom());var t=r.metadataConfig.preloadPageCount,o=e.pages?e.pages.length:0;t>0&&r.preloadPages(1,t>o?o:t),r.navigateService.countPages=o,r.navigateService.currentPage=1,r.countPages=o,r.loadProperties()}})),o&&this.modalService.close(o),this.clearData()},e.prototype.preloadPages=function(e,t){for(var o=this,r=function(e){i.metadataService.loadPage(i.credentials,e).subscribe((function(t){o.file.pages[e-1]=t}))},i=this,n=e;n<=t;n++)r(n)},e.prototype.upload=function(e){var t=this;this.metadataService.upload(null,e,this.rewriteConfig).subscribe((function(){t.selectDir("")}))},e.prototype.fileDropped=function(e){this.fileWasDropped=e},e.prototype.ptToPx=function(e){return 96*e/72},e.prototype.getFitToWidth=function(){var e=this.ptToPx(this.pageWidth),t=this.ptToPx(this.pageHeight),o=e||window.innerWidth;return t>e&&Math.round(o/window.innerWidth)<2?200-Math.round(100*o/window.innerWidth):Math.round(100*window.innerWidth/o)},e.prototype.getFitToHeight=function(){var e=this.ptToPx(this.pageWidth),t=this.ptToPx(this.pageHeight),o=t>e?window.innerHeight-100:window.innerHeight+100,r=t||o;return t>e?Math.round(100*o/r):Math.round(100*r/o)},e.prototype.zoomOptions=function(){var e=this.getFitToWidth(),t=this.getFitToHeight();return this.zoomService.zoomOptions(e,t)},Object.defineProperty(e.prototype,"zoom",{get:function(){return this.previewZoom},set:function(e){this.previewZoom=e,this.zoomService.changeZoom(this.previewZoom)},enumerable:!0,configurable:!0}),e.prototype.refreshZoom=function(){this.zoom=this.windowService.isDesktop()?100:this.getFitToWidth()},e.prototype.downloadFile=function(){this.formatDisabled||window.location.assign(this.metadataService.getDownloadUrl(this.credentials))},e.prototype.exportProperties=function(){var e=this;this.formatDisabled||this.metadataService.exportProperties(this.credentials).subscribe((function(t){return e.saveBlob(t,"ExportedProperties.xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")}))},e.prototype.clearData=function(){var e,t;if(this.file&&this.file.pages)try{for(var o=c(this.file.pages),r=o.next();!r.done;r=o.next()){r.value.data=null}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}},e.prototype.isDisabled=function(){return!this.file||this.disabled},e.prototype.save=function(){var e=this;if(this.file&&this.file.pages){var t=new g;t.guid=this.file.guid,t.password=this.credentials.password,t.packages=this.packages.map((function(e){return{id:e.id,properties:e.properties.filter((function(e){return e.added||e.edited}))}})).filter((function(e){return e.properties.length>0})),t.packages.length>0&&this.metadataService.saveProperty(t).subscribe((function(t){e.loadProperties(),e.disabled=!1,e.modalService.open(n.CommonModals.OperationSuccess)}))}},e.prototype.cleanMetadata=function(){var e=this;this.formatDisabled||this.metadataService.cleanMetadata(this.credentials).subscribe((function(){e.loadProperties(),e.disabled=!1,e.modalService.open(n.CommonModals.OperationSuccess)}))},e.prototype.loadProperties=function(){var e=this;this.file&&(this.metadataService.loadProperties(this.credentials).subscribe((function(t){e.packages=t})),this.showSidePanel||(this.showSidePanel=!0))},e.prototype.hideSidePanel=function(e){this.showSidePanel=!this.showSidePanel},e.prototype.removeProperty=function(e){var t=this;if(this.file){var o=new g;o.guid=this.file.guid,o.password=this.credentials.password,o.packages=[{id:e.packageId,properties:[e.property]}],this.metadataService.removeProperty(o).subscribe((function(){t.loadProperties(),t.modalService.open(n.CommonModals.OperationSuccess)}))}},e.prototype.getPackageName=function(e){return e.name in M?e.index>=0?M[e.name].concat(" ",(e.index+1).toString(10)):M[e.name]:e.type in D?D[e.type]:b[e.type].toString()},e.prototype.saveBlob=function(e,t,o){var r=new Blob([e],{type:o});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(r);else{var i=window.URL.createObjectURL(r),n=document.createElement("a");n.href=i,n.download=t,n.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})),setTimeout((function(){window.URL.revokeObjectURL(i),n.remove()}),100)}},e.decorators=[{type:o.Component,args:[{selector:"gd-metadata",template:'<gd-loading-mask [loadingMask]="isLoading"></gd-loading-mask>\r\n<div class="wrapper">\r\n  <div class="row">\r\n    <div class="column">\r\n      <div class="top-panel">\r\n        <gd-logo [logo]="\'metadata\'" icon="clipboard-list"></gd-logo>\r\n        <gd-top-toolbar class="toolbar-panel">\r\n          <gd-button [icon]="\'folder-open\'" [tooltip]="\'Browse files\'" (click)="openModal(browseFilesModal)"\r\n                    *ngIf="browseConfig" ></gd-button>\r\n          <gd-button [disabled]="formatDisabled" [icon]="\'trash\'" [tooltip]="\'Clean Metadata\'" (click)="cleanMetadata()">\r\n                    </gd-button>\r\n          <gd-button [disabled]="formatDisabled" [icon]="\'save\'" [tooltip]="\'Save\'" (click)="save()">\r\n                    </gd-button>\r\n          <gd-button [hidden] ="isDesktop" [disabled]="formatDisabled" [icon]="\'file-export\'" [tooltip]="\'Attributes\'" (click)="loadProperties()">\r\n                    </gd-button>\r\n          <gd-button [disabled]="formatDisabled" [icon]="\'download\'" [tooltip]="\'Download\'"\r\n                    (click)="downloadFile()" *ngIf="downloadConfig" ></gd-button>\r\n          <gd-button [disabled]="formatDisabled" [icon]="\'file-excel\'" [tooltip]="\'Export Properties\'"\r\n                    (click)="exportProperties()" ></gd-button>\r\n        </gd-top-toolbar>\r\n      </div>\r\n      <div class="doc-panel" *ngIf="file" #docPanel>\r\n        <gd-document class="gd-document" *ngIf="file" [file]="file" [mode]="false" gdScrollable\r\n                    [preloadPageCount]="metadataConfig?.preloadPageCount" gdRenderPrint [htmlMode]="false"></gd-document>\r\n      </div>\r\n    </div>\r\n    <gd-side-panel *ngIf="file && showSidePanel"\r\n      (hideSidePanel)="hideSidePanel($event)"\r\n      (saveInSidePanel)="save()"\r\n      [closable]="isDesktop ? false : true"\r\n      [saveable]="isDesktop ? false : true"\r\n      [title]="\'Metadata\'"\r\n      [icon]="\'clipboard-list\'">\r\n      <gd-accordion>\r\n        <gd-accordion-group *ngFor="let package of packages" [title]="getPackageName(package)" [addDisabled]="false" [addHidden]="false" [properties]="package.properties" [knownProperties]="package.knownProperties" [packageId]="package.id" (removeProperty)="removeProperty($event)"></gd-accordion-group>\r\n      </gd-accordion>\r\n    </gd-side-panel>\r\n  </div>\r\n  <gd-init-state [icon]="\'clipboard-list\'" [text]="\'Drop file here to upload\'" *ngIf="!file && uploadConfig" (fileDropped)="fileDropped($event)">\r\n    Click <fa-icon [icon]="[\'fas\',\'folder-open\']"></fa-icon> to open file<br>\r\n    Or drop file here\r\n  </gd-init-state>\r\n  <gd-browse-files-modal (urlForUpload)="upload($event)" [files]="files" (selectedDirectory)="selectDir($event)"\r\n                         (selectedFileGuid)="selectFile($event, null, browseFilesModal)"\r\n                         [uploadConfig]="uploadConfig"></gd-browse-files-modal>\r\n\r\n  <gd-error-modal></gd-error-modal>\r\n  <gd-password-required></gd-password-required>\r\n  <gd-success-modal></gd-success-modal>\r\n</div>\r\n',styles:["@import url(https://fonts.googleapis.com/css?family=Open+Sans&display=swap);:host *{font-family:'Open Sans',Arial,Helvetica,sans-serif}.wrapper{-webkit-box-align:stretch;align-items:stretch;height:100%;width:100%;position:fixed;top:0;bottom:0;left:0;right:0}.doc-panel{display:-webkit-box;display:flex;height:calc(100vh - 60px);-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row}.top-panel{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;width:100%}.toolbar-panel{background-color:#3e4e5a;width:100%}::ng-deep .tools .button{color:#fff!important;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-flow:column}::ng-deep .tools .button.inactive{color:#959da5!important}::ng-deep .tools .icon-button{margin:0 0 0 7px!important}.row{display:-webkit-box;display:flex}.column{width:100%;overflow-x:hidden;overflow-y:hidden}::ng-deep .gd-side-panel-body{background-color:#f4f4f4}::ng-deep .gd-side-panel-wrapper{width:464px!important}::ng-deep .page.excel{overflow:unset!important}@media (max-width:1037px){::ng-deep .tools gd-button:nth-child(1)>.icon-button{margin:0 0 0 10px!important}::ng-deep .tools .icon-button{height:60px;width:60px}::ng-deep .gd-side-panel-wrapper{width:375px!important}}"]}]}],e.ctorParameters=function(){return[{type:u},{type:n.ModalService},{type:m},{type:n.UploadFilesService},{type:n.NavigateService},{type:n.ZoomService},{type:n.PagePreloadService},{type:n.PasswordService},{type:n.LoadingMaskService},{type:n.WindowService}]},e.propDecorators={initialFile:[{type:o.Input}]},e}();var C=function(){function e(){}return e.prototype.ngAfterContentInit=function(){},e.decorators=[{type:o.Component,args:[{selector:"gd-accordion",template:"\n    <ng-content></ng-content>\n",styles:[""]}]}],e}(),I=s,T=function(){function e(e){this.windowService=e,this.opened=!0,this.removeProperty=new o.EventEmitter,this.datePickerConfig={format:"DD-MM-YYYY HH:mm:ss"},this.editableTypes=new Set([v.String,v.Integer,v.Long,v.Double,v.Boolean,v.DateTime])}return e.prototype.ngOnInit=function(){var e=this;this.isDesktop=this.windowService.isDesktop(),this.windowService.onResize.subscribe((function(t){e.isDesktop=e.windowService.isDesktop()})),this.knownPropertyDictionary=this.toDictionary(this.knownProperties),this.updateNotAddedProperties(),this.metadataPropertyType=v},e.prototype.ngAfterViewInit=function(){this.textinput.changes.subscribe((function(e){e.length&&e.first.nativeElement.focus()}))},e.prototype.resetProperties=function(){this.properties.forEach((function(e){e.selected=!1,e.editing=!1}))},e.prototype.toggle=function(e){this.opened=!this.opened},e.prototype.addProperty=function(e){if(e.preventDefault(),e.stopPropagation(),this.resetProperties(),this.isAddAvailable()){var t=new w;t.added=!0,t.editing=!0,t.name="Select property",t.type=1,this.properties.push(t)}},e.prototype.selectProperty=function(e){this.resetProperties(),e.selected=!e.selected},e.prototype.editProperty=function(e){this.isEditable(e)&&(this.resetProperties(),e.editing=!e.editing,e.edited=!0)},e.prototype.delete=function(e){e.preventDefault(),e.stopPropagation();var t=this.properties.filter((function(e){return e.selected}))[0];this.removeProperty.emit({packageId:this.packageId,property:t})},e.prototype.isRemoveAvailable=function(){var e=this;return this.properties&&1===this.properties.filter((function(t){return t.selected&&e.isRemovable(t)})).length},e.prototype.isAddAvailable=function(){return!this.addDisabled&&this.notAddedProperties.length>0},e.prototype.selectPropName=function(e,t){t.type=e.type,t.name=e.name,e.type===v.DateTime?t.value=I().toISOString():t.value="",this.updateNotAddedProperties()},e.prototype.formatValue=function(e){switch(e.type){case v.DateTime:return this.dateToPicker(e.value);default:return e.value}},e.prototype.updateNotAddedProperties=function(){var e=this.toDictionary(this.properties);this.notAddedProperties=this.knownProperties.filter((function(t){return 0!=(t.accessLevel&y.Add)&&!(t.name in e)}))},e.prototype.isEditable=function(e){if(this.editableTypes.has(e.type))return this.hasAccessTo(e,y.Update)},e.prototype.isRemovable=function(e){return this.hasAccessTo(e,y.Remove)},e.prototype.hasAccessTo=function(e,t){return e.name in this.knownPropertyDictionary&&0!=(this.knownPropertyDictionary[e.name].accessLevel&t)},e.prototype.dateToPicker=function(e){return e?I.utc(e).local().format(this.datePickerConfig.format):null},e.prototype.dateFromPicker=function(e,t){if(t){var o=I(t,this.datePickerConfig.format);e.value=o.toISOString()}},e.prototype.toDictionary=function(e){return e.reduce((function(e,t){return e[t.name]=t,e}),{})},e.decorators=[{type:o.Component,args:[{selector:"gd-accordion-group",template:'<div class="accordion-wrapper">\r\n    <div class="title" (click)="toggle($event)">\r\n      <fa-icon *ngIf="!opened" class="chevron" [icon]="[\'fas\', \'chevron-down\']"></fa-icon>\r\n      <fa-icon *ngIf="opened" class="chevron" [icon]="[\'fas\', \'chevron-up\']"></fa-icon>\r\n      <div class="text">{{title}}</div>\r\n      <fa-icon class="trash" *ngIf="isRemoveAvailable()" [icon]="[\'fas\', \'trash\']" (click)="delete($event)"></fa-icon>\r\n      <gd-button class="plus" [icon]="[\'plus\']" [hidden]="addHidden" [disabled]="!isAddAvailable()" (click)="addProperty($event)"></gd-button>\r\n    </div>\r\n    <div class="body" [ngClass]="{\'hidden\': !opened}">\r\n      <div *ngFor="let property of properties" class="property-wrapper">\r\n          <div *ngIf="!property.added" [ngClass]="{\'selected\': property.selected, \'disabled\': !isEditable(property)}" (click)="selectProperty(property)" class="property-name property-name-simple" title="{{property.name}}">{{property.name}}</div>\r\n          <gd-select  class="property-name" *ngIf="property.added" id="propertiesNames" [disabled]="false" [options]="notAddedProperties" (selected)="selectPropName($event, property)" [showSelected]="{name : property.name, value : property.name}"></gd-select>\r\n          <div *ngIf="!property.editing" [ngClass]="{\'selected\': property.selected}" (click)="editProperty(property)" class="property-value" title="{{property.value}}">{{formatValue(property)}}</div>\r\n          <div *ngIf="property.editing" class="input-wrapper">\r\n            <input #textinput *ngIf="property.type == metadataPropertyType.String" class="property-value" [(ngModel)]="property.value" />\r\n            <input *ngIf="property.type == metadataPropertyType.Integer || property.type == metadataPropertyType.Long" type="text" class="property-value" [(ngModel)]="property.value" gdInteger />\r\n            <input *ngIf="property.type == metadataPropertyType.Double" type="number" class="property-value" [(ngModel)]="property.value" />\r\n            <input *ngIf="property.type == metadataPropertyType.Boolean" type="checkbox" class="property-value" [(ngModel)]="property.value" />\r\n            <dp-date-picker *ngIf="property.type == metadataPropertyType.DateTime" [mode]="\'daytime\'" [theme]="\'dp-material dp-main\'" [config]="datePickerConfig" [ngModel]="dateToPicker(property.value)" (ngModelChange)="dateFromPicker(property, $event)" ></dp-date-picker>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  <div>',styles:[".accordion-wrapper{background-color:#fff}.accordion-wrapper .title{width:100%;cursor:pointer;border-bottom:1px solid #6e6e6e;background-color:#539cf0;color:#f4f4f4;font-weight:700;display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row;height:37px;line-height:37px;font-size:13px}.accordion-wrapper .title .text{width:100%}.chevron{padding:0 16px 0 15px}.plus{margin-left:auto}::ng-deep .title .button{color:#fff!important;display:block!important;margin-right:0!important}::ng-deep .title .button.active fa-icon{color:#fff!important}.accordion-wrapper .body.hidden,.trash.hidden{display:none}.property-wrapper{display:-webkit-box;display:flex;height:35px;font-size:12px;border-bottom:1px solid #e7e7e7;line-height:35px}.property-wrapper.disabled{cursor:not-allowed;color:#acacac}.property-name{width:216px;text-transform:uppercase;font-weight:700;padding-left:15px;border-right:1px solid #e7e7e7;text-overflow:ellipsis;word-wrap:break-word}.property-name.disabled{color:#acacac}.property-name ::ng-deep .select{height:35px;line-height:37px;text-align:center;-webkit-box-pack:unset;justify-content:unset;position:relative}.property-name ::ng-deep .select .nav-caret{display:none}.property-name ::ng-deep .select .selected-value{max-width:none;font-size:unset;text-transform:none;font-weight:400}.property-name ::ng-deep .select .dropdown-menu{width:216px;margin-left:-15px;top:36px}.property-name-simple{overflow-x:hidden;word-wrap:normal}.property-value{font-family:'Courier New',Courier,monospace;padding-left:12px;text-overflow:ellipsis;width:216px;white-space:nowrap;overflow:hidden;word-wrap:break-word;display:inline-block}.property-value.desktop-hide{display:none}::ng-deep dp-date-picker.dp-material .dp-picker-input,::ng-deep dp-day-time-calendar *{font-family:'Courier New',Courier,monospace}.input-wrapper input{height:30px;border:0;font-size:12px}.input-wrapper input.hidden{display:none}.input-wrapper input[type=datetime-local]::-webkit-clear-button,.input-wrapper input[type=datetime-local]::-webkit-inner-spin-button{-webkit-appearance:none;display:none}.selected{background-color:#3e4e5a;color:#fff}::ng-deep .default .property-name{color:#acacac}@media (max-width:1037px){.property-value{width:194px!important}.property-name{width:150px!important}.property-value.mobile-hide{display:none}.input-wrapper{width:185px!important}}"]}]}],e.ctorParameters=function(){return[{type:n.WindowService}]},e.propDecorators={knownProperties:[{type:o.Input}],opened:[{type:o.Input}],title:[{type:o.Input}],packageId:[{type:o.Input}],addDisabled:[{type:o.Input}],addHidden:[{type:o.Input}],properties:[{type:o.Input}],removeProperty:[{type:o.Output}],textinput:[{type:o.ViewChildren,args:["textinput"]}]},e}();var O=function(){function e(){this._addingObserver=new a.BehaviorSubject(null),this._addedProperty=this._addingObserver.asObservable()}return Object.defineProperty(e.prototype,"addedProperty",{get:function(){return this._addedProperty},enumerable:!0,configurable:!0}),e.prototype.addProperty=function(e){this._addingObserver.next(e)},e.decorators=[{type:o.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[]},e.ngInjectableDef=o.ɵɵdefineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}();var E=function(){function e(e,t){this.ngModel=e,this.element=t,this.specialKeys=["Backspace","Tab","End","Home","ArrowLeft","ArrowRight","Delete"]}return e.prototype.isInteger=function(e){return String(e).match(new RegExp(/^(\-){0,1}\d*$/))},e.prototype.onKeyDown=function(e){if(-1===this.specialKeys.indexOf(e.key)){var t=this.element.nativeElement.value,o=this.element.nativeElement.selectionStart,r=[t.slice(0,o),e.key,t.slice(o)].join("");r&&!this.isInteger(r)&&e.preventDefault()}},e.prototype.ngOnInit=function(){var e=this;this.ngModel.control.valueChanges.subscribe((function(){var t=e.element.nativeElement.value;t&&e.ngModel.control.setValue("-"===t?0:parseInt(t,10),{emitModelToViewChange:!1,emitViewToModelChange:!0,emitEvent:!1})}))},e.decorators=[{type:o.Directive,args:[{selector:"[gdInteger]"}]}],e.ctorParameters=function(){return[{type:d.NgModel},{type:o.ElementRef}]},e.propDecorators={onKeyDown:[{type:o.HostListener,args:["keydown",["$event"]]}]},e}();function F(e){return function(){return e.load()}}function _(e){return new n.LoadingMaskInterceptorService(e)}var R=function(){function e(){}return e.forRoot=function(t){return n.Api.DEFAULT_API_ENDPOINT=t,{ngModule:e}},e.decorators=[{type:o.NgModule,args:[{declarations:[x,C,T,E],imports:[t.BrowserModule,n.CommonComponentsModule,i.HttpClientModule,p.FontAwesomeModule,d.FormsModule,l.DpDatePickerModule],exports:[x,n.CommonComponentsModule,C,T],providers:[u,O,n.ConfigService,r.DatePipe,m,{provide:i.HTTP_INTERCEPTORS,useClass:n.ErrorInterceptorService,multi:!0},{provide:o.APP_INITIALIZER,useFactory:F,deps:[m],multi:!0},n.LoadingMaskService,{provide:i.HTTP_INTERCEPTORS,useFactory:_,multi:!0,deps:[n.LoadingMaskService]}]}]}],e}();e.AccessLevels=y,e.AccordionService=O,e.ChangedPackageModel=A,e.FilePropertyModel=w,e.KnownPropertyModel=P,e.MetadataAppComponent=x,e.MetadataConfigService=m,e.MetadataFileDescription=g,e.MetadataModule=R,e.MetadataPropertyType=v,e.MetadataService=u,e.MetadataType=b,e.PackageModel=k,e.PackageNameByMetadataType=D,e.PackageNameByOriginalName=M,e.RemovePropertyModel=S,e.initializeApp=F,e.setupLoadingInterceptor=_,e.ɵa=C,e.ɵb=T,e.ɵc=E,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=groupdocs.examples.angular-metadata.umd.min.js.map